{
  "case_id": "OSP-19E467FA",
  "document_type": "passport",
  "original_filename": "IMG_7496.png",
  "stored_filename": "passport_20251010_205553_bfc474a23cf14c9d_IMG_7496.png",
  "file_hash": "bfc474a23cf14c9d",
  "file_size": 731813,
  "stored_at": "2025-10-10T20:55:53.905506+00:00",
  "analysis_result": {
    "valid": true,
    "legible": true,
    "completeness": 80,
    "issues": [],
    "extracted_data": {
      "document_type": "passport",
      "file_name": "IMG_7496.png",
      "validation_status": "PROCESSED",
      "visa_context": "O-1",
      "full_name": "Completo:** Leonardo de Souza Neto",
      "detected_type": "passport",
      "confidence": 0.8,
      "analysis_method": "native_llm_restored",
      "full_text_extracted": "**DECIS√ÉO: REJEITADO**\n\n**JUSTIFICATIVA:** O documento analisado √© uma Carteira Nacional de Habilita√ß√£o (CNH), e n√£o um passaporte, que era o tipo de documento esperado.\n\n**TIPO DETECTADO:** Carteira Nacional de Habilita√ß√£o (CNH)\n\n**QUALIDADE:** Boa\n\n**DADOS PRINCIPAIS:** \n- **Nome Completo:** Leonardo de Souza Neto\n- **N¬∫ do Documento:** 2312795962\n- **Data de Nascimento:** 23/04/1998\n- **Validade:** 09/05/2032\n- **Nacionalidade:** Brasileira\n\nO nome no documento (\"Leonardo de Souza Neto\") n√£o corresponde ao nome cadastrado (\"Usu√°rio\").",
      "security_features": [],
      "quality_score": 0.8
    },
    "dra_paula_assessment": "‚úÖ DOCUMENTO ANALISADO: passport processado com vis√£o real",
    "policy_engine": {
      "document_id": "doc_5376",
      "doc_type": "PASSPORT_ID_PAGE",
      "status": "done",
      "quality": {
        "status": "ok",
        "checks": {
          "file_size": {
            "status": "pass",
            "message": "Arquivo: 714.7KB (0.7MB)",
            "size_bytes": 731813,
            "size_kb": 714.6611328125,
            "size_mb": 0.697911262512207
          },
          "format": {
            "status": "pass",
            "message": "Formato: image/png",
            "mime_type": "image/png",
            "supported": true,
            "magic_bytes_detected": "png"
          },
          "image_specific": {
            "status": "pass",
            "message": "Imagem 1320x2868, RGB",
            "width": 1320,
            "height": 2868,
            "mode": "RGB",
            "estimated_dpi": 155.2941176470588,
            "blur_score": 3411.790075316779,
            "warnings": []
          }
        },
        "warnings": [],
        "errors": [],
        "metadata": {}
      },
      "policy_checks": [
        {
          "rule": "quality:min_dpi",
          "result": "alert",
          "message": "DPI estimado (155) abaixo do m√≠nimo (200)",
          "severity": "medium"
        },
        {
          "rule": "quality:file_size",
          "result": "pass",
          "message": "Arquivo: 714.7KB (0.7MB)",
          "severity": "low"
        },
        {
          "rule": "language:english_detected",
          "result": "pass",
          "message": "Documento em ingl√™s ou traduzido",
          "severity": "low"
        }
      ],
      "fields": {
        "passport_number": [
          {
            "value": "Document",
            "normalized_value": "DOCUMENT",
            "confidence": 0.64,
            "validation": {
              "is_valid": true,
              "confidence": 0.85,
              "normalized_value": "DOCUMENT",
              "issues": [],
              "validation_method": "nationality_aware_passport_validator"
            },
            "position": {
              "start_pos": 0,
              "end_pos": 8,
              "line_number": 1,
              "context_before": "",
              "context_after": "type: passport, Filename: IMG_7496.png"
            },
            "pattern_used": "\\b([A-Z0-9]{6,12})\\b",
            "field_type": "passport_number"
          },
          {
            "value": "passport",
            "normalized_value": "PASSPORT",
            "confidence": 0.64,
            "validation": {
              "is_valid": true,
              "confidence": 0.85,
              "normalized_value": "PASSPORT",
              "issues": [],
              "validation_method": "nationality_aware_passport_validator"
            },
            "position": {
              "start_pos": 15,
              "end_pos": 23,
              "line_number": 1,
              "context_before": "Document type:",
              "context_after": ", Filename: IMG_7496.png"
            },
            "pattern_used": "\\b([A-Z0-9]{6,12})\\b",
            "field_type": "passport_number"
          },
          {
            "value": "Filename",
            "normalized_value": "FILENAME",
            "confidence": 0.64,
            "validation": {
              "is_valid": true,
              "confidence": 0.85,
              "normalized_value": "FILENAME",
              "issues": [],
              "validation_method": "nationality_aware_passport_validator"
            },
            "position": {
              "start_pos": 25,
              "end_pos": 33,
              "line_number": 1,
              "context_before": "Document type: passport,",
              "context_after": ": IMG_7496.png"
            },
            "pattern_used": "\\b([A-Z0-9]{6,12})\\b",
            "field_type": "passport_number"
          }
        ],
        "name_fields": [
          {
            "value": "IMG",
            "normalized_value": "Img",
            "confidence": 0.7600000000000001,
            "validation": {
              "is_valid": true,
              "confidence": 0.85,
              "normalized_value": "Img",
              "issues": [],
              "validation_method": "name_format_validator"
            },
            "position": {
              "start_pos": 29,
              "end_pos": 38,
              "line_number": 1,
              "context_before": "Document type: passport, File",
              "context_after": "_7496.png"
            },
            "pattern_used": "(?:Name|Nome|Surname|Apellido)[:\\s]*([A-Z][a-zA-Z\\s\\-\\']{2,50})",
            "field_type": "name_fields"
          }
        ],
        "policy_fields": {
          "full_name": {
            "found": true,
            "values": [
              {
                "value": "Document type: passport, Filename: IMG_7496.png",
                "normalized_value": "Document type: passport, Filename: IMG_7496.png",
                "confidence": 0.8,
                "validation": {
                  "field_name": "full_name",
                  "original_value": "Document type: passport, Filename: IMG_7496.png",
                  "is_valid": true,
                  "confidence": 0.8,
                  "normalized_value": "Document type: passport, Filename: IMG_7496.png",
                  "validation_method": "basic_presence_check",
                  "issues": [],
                  "recommendations": []
                },
                "position": {
                  "start_pos": 0,
                  "end_pos": 47,
                  "line_number": 1,
                  "context_before": "",
                  "context_after": ""
                },
                "is_required": true,
                "description": "Nome completo do portador do passaporte"
              }
            ],
            "required": true,
            "best_match": {
              "value": "Document type: passport, Filename: IMG_7496.png",
              "normalized_value": "Document type: passport, Filename: IMG_7496.png",
              "confidence": 0.8,
              "validation": {
                "field_name": "full_name",
                "original_value": "Document type: passport, Filename: IMG_7496.png",
                "is_valid": true,
                "confidence": 0.8,
                "normalized_value": "Document type: passport, Filename: IMG_7496.png",
                "validation_method": "basic_presence_check",
                "issues": [],
                "recommendations": []
              },
              "position": {
                "start_pos": 0,
                "end_pos": 47,
                "line_number": 1,
                "context_before": "",
                "context_after": ""
              },
              "is_required": true,
              "description": "Nome completo do portador do passaporte"
            }
          },
          "passport_number": {
            "found": true,
            "values": [
              {
                "value": "Document",
                "normalized_value": "Document",
                "confidence": 0.85,
                "validation": {
                  "field_name": "passport_number",
                  "original_value": "Document",
                  "is_valid": true,
                  "confidence": 0.85,
                  "normalized_value": "Document",
                  "validation_method": "nationality_aware_passport",
                  "issues": [],
                  "recommendations": []
                },
                "position": {
                  "start_pos": 0,
                  "end_pos": 8,
                  "line_number": 1,
                  "context_before": "",
                  "context_after": "type: passport, Filename: IMG_7496.png"
                },
                "is_required": true,
                "description": "N√∫mero do passaporte"
              },
              {
                "value": "passport",
                "normalized_value": "passport",
                "confidence": 0.85,
                "validation": {
                  "field_name": "passport_number",
                  "original_value": "passport",
                  "is_valid": true,
                  "confidence": 0.85,
                  "normalized_value": "passport",
                  "validation_method": "nationality_aware_passport",
                  "issues": [],
                  "recommendations": []
                },
                "position": {
                  "start_pos": 15,
                  "end_pos": 23,
                  "line_number": 1,
                  "context_before": "Document type:",
                  "context_after": ", Filename: IMG_7496.png"
                },
                "is_required": true,
                "description": "N√∫mero do passaporte"
              },
              {
                "value": "Filename",
                "normalized_value": "Filename",
                "confidence": 0.85,
                "validation": {
                  "field_name": "passport_number",
                  "original_value": "Filename",
                  "is_valid": true,
                  "confidence": 0.85,
                  "normalized_value": "Filename",
                  "validation_method": "nationality_aware_passport",
                  "issues": [],
                  "recommendations": []
                },
                "position": {
                  "start_pos": 25,
                  "end_pos": 33,
                  "line_number": 1,
                  "context_before": "Document type: passport,",
                  "context_after": ": IMG_7496.png"
                },
                "is_required": true,
                "description": "N√∫mero do passaporte"
              }
            ],
            "required": true,
            "best_match": {
              "value": "Document",
              "normalized_value": "Document",
              "confidence": 0.85,
              "validation": {
                "field_name": "passport_number",
                "original_value": "Document",
                "is_valid": true,
                "confidence": 0.85,
                "normalized_value": "Document",
                "validation_method": "nationality_aware_passport",
                "issues": [],
                "recommendations": []
              },
              "position": {
                "start_pos": 0,
                "end_pos": 8,
                "line_number": 1,
                "context_before": "",
                "context_after": "type: passport, Filename: IMG_7496.png"
              },
              "is_required": true,
              "description": "N√∫mero do passaporte"
            }
          },
          "date_of_birth": {
            "found": false,
            "values": [],
            "required": true,
            "best_match": null
          },
          "expiry_date": {
            "found": false,
            "values": [],
            "required": true,
            "best_match": null
          },
          "nationality": {
            "found": true,
            "values": [
              {
                "value": "Document type: passport, Filename: IMG_7496.png",
                "normalized_value": "Document type: passport, Filename: IMG_7496.png",
                "confidence": 0.8,
                "validation": {
                  "field_name": "nationality",
                  "original_value": "Document type: passport, Filename: IMG_7496.png",
                  "is_valid": true,
                  "confidence": 0.8,
                  "normalized_value": "Document type: passport, Filename: IMG_7496.png",
                  "validation_method": "basic_presence_check",
                  "issues": [],
                  "recommendations": []
                },
                "position": {
                  "start_pos": 0,
                  "end_pos": 47,
                  "line_number": 1,
                  "context_before": "",
                  "context_after": ""
                },
                "is_required": true,
                "description": "Nacionalidade"
              }
            ],
            "required": true,
            "best_match": {
              "value": "Document type: passport, Filename: IMG_7496.png",
              "normalized_value": "Document type: passport, Filename: IMG_7496.png",
              "confidence": 0.8,
              "validation": {
                "field_name": "nationality",
                "original_value": "Document type: passport, Filename: IMG_7496.png",
                "is_valid": true,
                "confidence": 0.8,
                "normalized_value": "Document type: passport, Filename: IMG_7496.png",
                "validation_method": "basic_presence_check",
                "issues": [],
                "recommendations": []
              },
              "position": {
                "start_pos": 0,
                "end_pos": 47,
                "line_number": 1,
                "context_before": "",
                "context_after": ""
              },
              "is_required": true,
              "description": "Nacionalidade"
            }
          },
          "place_of_birth": {
            "found": true,
            "values": [
              {
                "value": "Document type: passport, Filename: IMG_7496.png",
                "normalized_value": "Document type: passport, Filename: IMG_7496.png",
                "confidence": 0.8,
                "validation": {
                  "field_name": "place_of_birth",
                  "original_value": "Document type: passport, Filename: IMG_7496.png",
                  "is_valid": true,
                  "confidence": 0.8,
                  "normalized_value": "Document type: passport, Filename: IMG_7496.png",
                  "validation_method": "basic_presence_check",
                  "issues": [],
                  "recommendations": []
                },
                "position": {
                  "start_pos": 0,
                  "end_pos": 47,
                  "line_number": 1,
                  "context_before": "",
                  "context_after": ""
                },
                "is_required": true,
                "description": "Local de nascimento"
              }
            ],
            "required": true,
            "best_match": {
              "value": "Document type: passport, Filename: IMG_7496.png",
              "normalized_value": "Document type: passport, Filename: IMG_7496.png",
              "confidence": 0.8,
              "validation": {
                "field_name": "place_of_birth",
                "original_value": "Document type: passport, Filename: IMG_7496.png",
                "is_valid": true,
                "confidence": 0.8,
                "normalized_value": "Document type: passport, Filename: IMG_7496.png",
                "validation_method": "basic_presence_check",
                "issues": [],
                "recommendations": []
              },
              "position": {
                "start_pos": 0,
                "end_pos": 47,
                "line_number": 1,
                "context_before": "",
                "context_after": ""
              },
              "is_required": true,
              "description": "Local de nascimento"
            }
          }
        }
      },
      "consistency": [],
      "overall_score": 0.7570833333333333,
      "decision": "FAIL",
      "messages": [
        "‚ùå Documento rejeitado - Corrija os problemas identificados",
        "üåê Idioma: Document in unknown requires certified English translation",
        "‚Ä¢ Certified Translation Required: Document in unknown requires certified English translation",
        "üìã Campos obrigat√≥rios n√£o encontrados: date_of_birth, expiry_date"
      ],
      "language_analysis": {
        "document_type": "PASSPORT_ID_PAGE",
        "language_detection": {
          "primary_language": "unknown",
          "confidence": 0.0,
          "language_scores": {},
          "mixed_language": false,
          "text_length": 47
        },
        "translation_rule": {
          "rule": "CFR_103_2_b_3",
          "english_required": false,
          "certified_translation_required": true,
          "acceptable_languages": [
            "en"
          ],
          "exceptions": [
            "mrz_section"
          ],
          "description": "8 CFR 103.2(b)(3) - Foreign language documents must be accompanied by certified English translation"
        },
        "compliance": {
          "status": "requires_translation",
          "compliant": false,
          "requires_translation": true,
          "message": "Document in unknown requires certified English translation",
          "severity": "high",
          "rule_reference": "CFR_103_2_b_3"
        },
        "recommendations": [
          {
            "type": "translation_required",
            "severity": "high",
            "title": "Certified Translation Required",
            "description": "Document in unknown requires certified English translation",
            "actions": [
              "Obtain certified English translation from qualified translator",
              "Ensure translator provides certificate of accuracy",
              "Submit both original document and certified translation",
              "Translation must comply with CFR_103_2_b_3"
            ],
            "rule_reference": "CFR_103_2_b_3"
          },
          {
            "type": "quality_improvement",
            "severity": "medium",
            "title": "Document Quality Issue",
            "description": "Text extraction confidence is low - document may be unclear",
            "actions": [
              "Ensure document is high resolution and clearly legible",
              "Check for proper scanning/photo quality",
              "Consider re-scanning if text appears blurry"
            ]
          }
        ],
        "status": "requires_translation",
        "requires_action": true
      },
      "translation_certificate": {
        "has_translation_certificate": false,
        "indicators_found": [],
        "confidence": 0.0,
        "status": "not_found"
      }
    },
    "standardized_doc_type": "PASSPORT_ID_PAGE",
    "quality_analysis": {
      "status": "ok",
      "checks": {
        "file_size": {
          "status": "pass",
          "message": "Arquivo: 714.7KB (0.7MB)",
          "size_bytes": 731813,
          "size_kb": 714.6611328125,
          "size_mb": 0.697911262512207
        },
        "format": {
          "status": "pass",
          "message": "Formato: image/png",
          "mime_type": "image/png",
          "supported": true,
          "magic_bytes_detected": "png"
        },
        "image_specific": {
          "status": "pass",
          "message": "Imagem 1320x2868, RGB",
          "width": 1320,
          "height": 2868,
          "mode": "RGB",
          "estimated_dpi": 155.2941176470588,
          "blur_score": 3411.790075316779,
          "warnings": []
        }
      },
      "warnings": [],
      "errors": [],
      "metadata": {}
    },
    "policy_score": 0.7570833333333333,
    "policy_decision": "FAIL"
  },
  "custom_metadata": {}
}